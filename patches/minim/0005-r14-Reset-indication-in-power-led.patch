From fddecf058a888c05334e36d9962b1dbac3e5fd7e Mon Sep 17 00:00:00 2001
From: Sagar Jain <sagarj@minim.com>
Date: Thu, 15 Dec 2022 20:25:58 +0530
Subject: [PATCH 1/1] r14: Reset  indication in power led.

SW-2878
---
 package/base-files/files/etc/rc.button/reset | 25 ++++++--------------
 1 file changed, 7 insertions(+), 18 deletions(-)

diff --git a/package/base-files/files/etc/rc.button/reset b/package/base-files/files/etc/rc.button/reset
index 43ffae0a18..3fc318cff3 100755
--- a/package/base-files/files/etc/rc.button/reset
+++ b/package/base-files/files/etc/rc.button/reset
@@ -6,26 +6,15 @@ OVERLAY="$( grep ' /overlay ' /proc/mounts )"
 
 case "$ACTION" in
 pressed)
-	[ -z "$OVERLAY" ] && return 0
-	sleep 10
-	/sbin/leds.sh led_factory_defaults
-	return 10
+        [ -z "$OVERLAY" ] && return 0
+
+        return 10
 ;;
 timeout)
-	. /etc/diag.sh
-	set_state failsafe
-;;
-released)
-	if [ "$SEEN" -lt 1 ]
-	then
-		echo "REBOOT" > /dev/console
-		sync
-		reboot
-	elif [ "$SEEN" -ge 10 -a -n "$OVERLAY" ]
-	then
-		echo "FACTORY RESET" > /dev/console
-		jffs2reset -y && reboot &
-	fi
+        /sbin/leds.sh "led_factory_defaults"
+        echo "FACTORY RESET" > /dev/console
+        sleep 3
+        /sbin/factory_reset.sh
 ;;
 esac
 
-- 
2.25.1

